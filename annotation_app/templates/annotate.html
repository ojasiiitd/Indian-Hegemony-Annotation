{% extends "layout/base.html" %}

{% block content %}

<h1 class="title">Cultural Hegemony Annotation</h1>
<p class="subtitle">
This task evaluates cultural hegemony in LLM-generated responses across Indian States.
</p>

<form method="POST">

  <!-- ================================================= -->
  <!-- REGION / STATE -->
  <!-- ================================================= -->
  {% include "components/region_state.html" %}

  <hr>

  <!-- ================================================= -->
  <!-- PROMPTS (SHARED ACROSS MODELS) -->
  <!-- ================================================= -->
  <div class="columns is-variable is-6">

    <div class="column">
      <label class="label">Base Prompt</label>
      <textarea class="textarea"
                name="base_prompt"
                rows="3"
                required>{{ draft.prompts.base if draft }}</textarea>
    </div>

    <div class="column">
      <label class="label">Identity-Primed Prompt</label>
      <textarea class="textarea"
                name="identity_primed_prompt"
                rows="3"
                required>{{ draft.prompts.identity if draft }}</textarea>
    </div>

  </div>

  <hr>

  <!-- ================================================= -->
  <!-- GEMINI MODEL -->
  <!-- ================================================= -->
  <h2 class="title is-4">Model 1</h2>

  <div class="columns is-variable is-6">

    <!-- GEMINI BASE -->
    <div class="column">

      <button type="button"
              class="button is-dark mb-3"
              onclick="generateOutput('gemini','base')">
        Gemini
      </button>

      <textarea class="textarea"
          id="gemini_llm_output_base"
          name="gemini_base_output"
          rows="15"
          readonly
          required>{{ draft.outputs.gemini.base.text if draft }}</textarea>

      {% with model="gemini" , kind="base" %}
        {% include "components/hegemony_axes.html" %}
      {% endwith %}
    </div>

    <!-- GEMINI IDENTITY -->
    <div class="column">

      <button type="button"
              class="button is-dark mb-3"
              onclick="generateOutput('gemini','identity')">
        Gemini
      </button>

      <textarea class="textarea"
          id="gemini_llm_output_identity"
          name="gemini_identity_output"
          rows="15"
          readonly>{{ draft.outputs.gemini.identity.text if draft }}</textarea>

      {% with model="gemini" , kind="identity" %}
        {% include "components/hegemony_axes.html" %}
      {% endwith %}
    </div>

  </div>

  <hr>

  <!-- ================================================= -->
  <!-- GPT MODEL -->
  <!-- ================================================= -->
  <h2 class="title is-4">Model 2</h2>

  <div class="columns is-variable is-6">

    <!-- GPT BASE -->
    <div class="column">

      <button type="button"
              class="button is-link mb-3"
              onclick="generateOutput('chatgpt','base')">
        GPT
      </button>

      <textarea class="textarea"
          id="chatgpt_llm_output_base"
          name="gpt_base_output"
          rows="15"
          readonly>{{ draft.outputs.gpt.base.text if draft }}</textarea>

      {% with model="gpt" , kind="base" %}
        {% include "components/hegemony_axes.html" %}
      {% endwith %}
    </div>

    <!-- GPT IDENTITY -->
    <div class="column">

      <button type="button"
              class="button is-link mb-3"
              onclick="generateOutput('chatgpt','identity')">
        GPT
      </button>

      <textarea class="textarea"
          id="chatgpt_llm_output_identity"
          name="gpt_identity_output"
          rows="15"
          readonly>{{ draft.outputs.gpt.identity.text if draft }}</textarea>

      {% with model="gpt" , kind="identity" %}
        {% include "components/hegemony_axes.html" %}
      {% endwith %}
    </div>

  </div>

  <hr>

  <!-- ================================================= -->
  <!-- LLama MODEL -->
  <!-- ================================================= -->
  <h2 class="title is-4">Model 3</h2>

  <div class="columns is-variable is-6">

    <!-- LLama BASE -->
    <div class="column">

      <button type="button"
              class="button is-warning mb-3"
              onclick="generateOutput('llama','base')">
        LLama
      </button>

      <textarea class="textarea"
          id="llama_llm_output_base"
          name="llama_base_output"
          rows="15"
          readonly>{{ draft.outputs.llama.base.text if draft }}</textarea>

      {% with model="llama" , kind="base" %}
        {% include "components/hegemony_axes.html" %}
      {% endwith %}
    </div>

    <!-- LLama IDENTITY -->
    <div class="column">

      <button type="button"
              class="button is-warning mb-3"
              onclick="generateOutput('llama','identity')">
        LLama
      </button>

      <textarea class="textarea"
          id="llama_llm_output_identity"
          name="llama_identity_output"
          rows="15"
          readonly>{{ draft.outputs.llama.identity.text if draft }}</textarea>

      {% with model="llama" , kind="identity" %}
        {% include "components/hegemony_axes.html" %}
      {% endwith %}
    </div>

  </div>

  <hr>
  <!-- ================================================= -->
  <!-- GROUND TRUTH -->
  <!-- ================================================= -->
  <div class="field">
    <label class="label">Ground Truth (100–200 words)</label>
    <div class="content is-small">
      <p>
        Provide a contextually grounded, non-hegemonic description informed by sociological knowledge
        and everyday practices. The goal is <strong>meaningful correction, not perfection</strong>.
      </p>
    </div>
    <textarea class="textarea"
              name="ground_truth"
              rows="15"
              required>{{ draft.ground_truth if draft }}</textarea>
  </div>

  <!-- REFERENCES -->
  <div class="field">
    <label class="label">References (links only)</label>
    <textarea class="textarea"
              name="references"
              rows="3"
              placeholder="Paste URLs, one per line">{{ draft.references if draft }}</textarea>
  </div>

  <!-- SUBMIT -->
  <div class="field has-text-right">
    <button class="button is-info is-large" type="submit">
      Review Annotation →
    </button>
  </div>

</form>

{% endblock %}

{% block scripts %}
  {% include "scripts/annotate_scripts.html" %}
{% endblock %}