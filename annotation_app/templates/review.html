{% extends "layout/base.html" %}

{% block content %}

<h1 class="title">Review Annotation</h1>
<p class="subtitle">
Please verify your responses before final submission.
</p>

<hr>

<!-- ================================================= -->
<!-- REGION / STATE -->
<!-- ================================================= -->
<h2 class="title is-5">Region & State</h2>
<p>
  <strong>{{ record.region }}</strong> — {{ record.state }}
</p>

<hr>

<!-- ================================================= -->
<!-- PROMPTS -->
<!-- ================================================= -->
<h2 class="title is-5">Prompts</h2>

<div class="columns is-variable is-6">
  <div class="column">
    <p class="has-text-weight-semibold">Base Prompt</p>
    <pre class="wrapped-pre">{{ record.prompts.base }}</pre>
  </div>

  <div class="column">
    <p class="has-text-weight-semibold">Identity-Primed Prompt</p>
    <pre class="wrapped-pre">{{ record.prompts.identity }}</pre>
  </div>
</div>

<hr>

<!-- ================================================= -->
<!-- GEMINI OUTPUTS -->
<!-- ================================================= -->
<h2 class="title is-5">Gemini Outputs</h2>

<div class="columns is-variable is-6">

  <!-- GEMINI BASE -->
  <div class="column">
    <h3 class="title is-6">Gemini — Base Prompt</h3>

    <p class="has-text-weight-semibold">Output</p>
    <pre class="wrapped-pre">{{ record.outputs.gemini.base.text }}</pre>

    <p class="has-text-weight-semibold mt-3">Hegemony Axes</p>
    <ul>
      {% for axis, data in record.outputs.gemini.base.hegemony.items() %}
        <li>
          <strong>{{ axis|capitalize }}</strong>:
          {{ data.present }}
          {% if data.present == "yes" and data.impact %}
            — {{ data.impact }}
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  </div>

  <!-- GEMINI IDENTITY -->
  <div class="column">
    <h3 class="title is-6">Gemini — Identity-Primed Prompt</h3>

    <p class="has-text-weight-semibold">Output</p>
    <pre class="wrapped-pre">{{ record.outputs.gemini.identity.text }}</pre>

    <p class="has-text-weight-semibold mt-3">Hegemony Axes</p>
    <ul>
      {% for axis, data in record.outputs.gemini.identity.hegemony.items() %}
        <li>
          <strong>{{ axis|capitalize }}</strong>:
          {{ data.present }}
          {% if data.present == "yes" and data.impact %}
            — {{ data.impact }}
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  </div>

</div>

<hr>

<!-- ================================================= -->
<!-- GPT OUTPUTS -->
<!-- ================================================= -->
<h2 class="title is-5">GPT Outputs</h2>

<div class="columns is-variable is-6">

  <!-- GPT BASE -->
  <div class="column">
    <h3 class="title is-6">GPT — Base Prompt</h3>

    <p class="has-text-weight-semibold">Output</p>
    <pre class="wrapped-pre">{{ record.outputs.gpt.base.text }}</pre>

    <p class="has-text-weight-semibold mt-3">Hegemony Axes</p>
    <ul>
      {% for axis, data in record.outputs.gpt.base.hegemony.items() %}
        <li>
          <strong>{{ axis|capitalize }}</strong>:
          {{ data.present }}
          {% if data.present == "yes" and data.impact %}
            — {{ data.impact }}
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  </div>

  <!-- GPT IDENTITY -->
  <div class="column">
    <h3 class="title is-6">GPT — Identity-Primed Prompt</h3>

    <p class="has-text-weight-semibold">Output</p>
    <pre class="wrapped-pre">{{ record.outputs.gpt.identity.text }}</pre>

    <p class="has-text-weight-semibold mt-3">Hegemony Axes</p>
    <ul>
      {% for axis, data in record.outputs.gpt.identity.hegemony.items() %}
        <li>
          <strong>{{ axis|capitalize }}</strong>:
          {{ data.present }}
          {% if data.present == "yes" and data.impact %}
            — {{ data.impact }}
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  </div>

</div>

<hr>

<!-- ================================================= -->
<!-- LLAMA OUTPUTS -->
<!-- ================================================= -->
<h2 class="title is-5">LLama Outputs</h2>

<div class="columns is-variable is-6">

  <!-- LLAMA BASE -->
  <div class="column">
    <h3 class="title is-6">LLama — Base Prompt</h3>

    <p class="has-text-weight-semibold">Output</p>
    <pre class="wrapped-pre">{{ record.outputs.llama.base.text }}</pre>

    <p class="has-text-weight-semibold mt-3">Hegemony Axes</p>
    <ul>
      {% for axis, data in record.outputs.llama.base.hegemony.items() %}
        <li>
          <strong>{{ axis|capitalize }}</strong>:
          {{ data.present }}
          {% if data.present == "yes" and data.impact %}
            — {{ data.impact }}
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  </div>

  <!-- LLAMA IDENTITY -->
  <div class="column">
    <h3 class="title is-6">Llama — Identity-Primed Prompt</h3>

    <p class="has-text-weight-semibold">Output</p>
    <pre class="wrapped-pre">{{ record.outputs.llama.identity.text }}</pre>

    <p class="has-text-weight-semibold mt-3">Hegemony Axes</p>
    <ul>
      {% for axis, data in record.outputs.llama.identity.hegemony.items() %}
        <li>
          <strong>{{ axis|capitalize }}</strong>:
          {{ data.present }}
          {% if data.present == "yes" and data.impact %}
            — {{ data.impact }}
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  </div>

</div>

<hr>

<!-- ================================================= -->
<!-- GROUND TRUTH -->
<!-- ================================================= -->
<h2 class="title is-5">Ground Truth</h2>
<pre class="wrapped-pre">{{ record.ground_truth }}</pre>

<h2 class="title is-5 mt-4">References</h2>
<pre class="wrapped-pre">{{ record.references }}</pre>

<hr>

<!-- ================================================= -->
<!-- ACTIONS -->
<!-- ================================================= -->
<div class="columns is-vcentered">

  <!-- Edit -->
  <div class="column">
    <a href="{{ url_for('annotate') }}" class="button is-dark is-medium">
      ← Edit
    </a>
  </div>

  <!-- Confirm -->
  <div class="column has-text-right">
    <form method="POST" action="{{ url_for('confirm') }}">
      <input type="hidden" name="record" value='{{ record | tojson }}'>
      <button class="button is-success is-medium" type="submit">
        Confirm & Submit →
      </button>
    </form>
  </div>

</div>

{% endblock %}